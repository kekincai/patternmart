var s=Object.defineProperty;var c=(r,e,o)=>e in r?s(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o;var i=(r,e,o)=>c(r,typeof e!="symbol"?e+"":e,o);import{LocalJsonCouponProvider as l}from"./LocalJsonCouponProvider-BF4-LJGx.js";import{D as n}from"./index-BbVyqgXj.js";class d{constructor(e){i(this,"localProvider");i(this,"remoteProvider");e instanceof l?this.localProvider=e:this.remoteProvider=e}async getCoupons(){return this.localProvider?(n.log("Adapter","适配本地数据源格式..."),this.localProvider.fetchLocalCoupons().map(o=>this.adaptLocalCoupon(o))):this.remoteProvider?(n.log("Adapter","适配远程数据源格式..."),(await this.remoteProvider.fetchRemoteCoupons()).map(o=>this.adaptRemoteCoupon(o))):[]}async getCouponByCode(e){if(this.localProvider){const o=this.localProvider.findByCode(e);return o?this.adaptLocalCoupon(o):null}if(this.remoteProvider){const o=await this.remoteProvider.findByPromoCode(e);return o?this.adaptRemoteCoupon(o):null}return null}adaptLocalCoupon(e){let o="fixed",t=e.discount_value;return e.discount_type==="percentage"?o="percent":e.discount_type==="free_shipping"&&(o="freeShip",t=0),{code:e.coupon_code,type:o,value:t,description:e.desc,minAmount:e.min_order}}adaptRemoteCoupon(e){let o="fixed",t=0;return e.discountPercent?(o="percent",t=e.discountPercent):e.discountAmount?(o="fixed",t=e.discountAmount):e.freeShipping&&(o="freeShip",t=0),{code:e.promoCode,type:o,value:t,description:e.label,minAmount:e.minimumPurchase}}}export{d as CouponProviderAdapter};
